define(function(){var e={alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",lookup:null,ie:/MSIE /.test(navigator.userAgent),ieo:/MSIE [67]/.test(navigator.userAgent),encode:function(t){var n,r,o=e.toUtf8(t),i=-1,a=o.length,s=[,,,];if(e.ie){for(var l=[];++i<a;)n=o[i+1],r=o[i+2],s[0]=o[i]>>2,s[1]=(3&o[i])<<4|o[++i]>>4,isNaN(n)?s[2]=s[3]=64:(s[2]=(15&o[i])<<2|o[++i]>>6,s[3]=isNaN(r)?64:63&o[i]),l.push(e.alphabet[s[0]],e.alphabet[s[1]],e.alphabet[s[2]],e.alphabet[s[3]]);return l.join("")}for(l="";++i<a;)n=o[i+1],r=o[i+2],s[0]=o[i]>>2,s[1]=(3&o[i])<<4|o[++i]>>4,isNaN(n)?s[2]=s[3]=64:(s[2]=(15&o[i])<<2|o[++i]>>6,s[3]=isNaN(r)?64:63&o[i]),l+=e.alphabet[s[0]]+e.alphabet[s[1]]+e.alphabet[s[2]]+e.alphabet[s[3]];return l},decode:function(t){var n=e.fromUtf8(t),r=0,o=n.length;if(e.ieo){for(result=[];o>r;)n[r]<128?result.push(String.fromCharCode(n[r++])):n[r]>191&&n[r]<224?result.push(String.fromCharCode((31&n[r++])<<6|63&n[r++])):result.push(String.fromCharCode((15&n[r++])<<12|(63&n[r++])<<6|63&n[r++]));return result.join("")}for(result="";o>r;)result+=n[r]<128?String.fromCharCode(n[r++]):n[r]>191&&n[r]<224?String.fromCharCode((31&n[r++])<<6|63&n[r++]):String.fromCharCode((15&n[r++])<<12|(63&n[r++])<<6|63&n[r++]);return result},toUtf8:function(e){var t,n=-1,r=e.length,o=[];if(/^[\x00-\x7f]*$/.test(e))for(;++n<r;)o.push(e.charCodeAt(n));else for(;++n<r;)t=e.charCodeAt(n),128>t?o.push(t):2048>t?o.push(192|t>>6,128|63&t):o.push(224|t>>12,128|63&t>>6,128|63&t);return o},fromUtf8:function(t){var n,r=-1,o=[],i=[,,,];if(!e.lookup){for(n=e.alphabet.length,e.lookup={};++r<n;)e.lookup[e.alphabet[r]]=r;r=-1}for(n=t.length;n>r&&(i[0]=e.lookup[t.charAt(++r)],i[1]=e.lookup[t.charAt(++r)],o.push(i[0]<<2|i[1]>>4),i[2]=e.lookup[t.charAt(++r)],64!=i[2])&&(o.push((15&i[1])<<4|i[2]>>2),i[3]=e.lookup[t.charAt(++r)],64!=i[3]);)o.push((3&i[2])<<6|i[3]);return o}};return e});