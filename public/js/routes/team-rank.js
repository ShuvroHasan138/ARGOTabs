(function(){define(["team","underscore"],function(t){return function(e,n){return n.when("/team-rank",{templateUrl:"partials/team-rank.html",controller:["$scope",function(e){var n,r,o,i;return n=function(){var t,n,r,o,i,a,s,u,l,c;if(o=e.tournament,n=o.rankFromTeams,t={},n.all)for(l=o.rounds,i=0,s=l.length;s>i;i++)r=l[i],r.paired&&(t[r.id]=!0);else for(c=o.rounds,a=0,u=c.length;u>a;a++)r=c[a],r.paired&&n[r.id]&&(t[r.id]=!0);return t},r=function(t){var r,o,i,a,s;for(r=[],null==t&&(t=n()),s=e.tournament.rounds,i=0,a=s.length;a>i;i++)o=s[i],t[o.id]&&r.push(o);return r},o=function(n){var o,i,a;return a=e.tournament,i=e.teams=a.teams.slice(0),null==n&&(n=r()),t.calculateStats(i,n),o=a.teamRankSorter.compareObjects,i.sort(function(t,e){return o(t.stats,e.stats)})},i=null,e.$watch(function(){return JSON.stringify(i=n())},function(){return o(r(i))})}]})}})}).call(this);